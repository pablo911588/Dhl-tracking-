
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Commander un envoi - DHL</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #ffffff;
    }
    header {
      background: #ffcc00;
      padding: 10px 15px;
      display: flex;
      align-items: center;
    }
    .logo {
      height: 30px;
    }
    .container {
      padding: 20px;
    }
    form {
      background: #f7f7f7;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 12px;
      margin-bottom: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px;
    }
    button {
      width: 100%;
      background: #cc0000;
      color: white;
      padding: 12px;
      border: none;
      border-radius: 5px;
      font-weight: bold;
      font-size: 16px;
      margin-top: 10px;
      cursor: pointer;
    }
    .message {
      margin-top: 15px;
      font-weight: bold;
      color: green;
    }
    footer {
      background: #fff;
      padding: 20px;
      text-align: center;
      font-size: 14px;
      color: #333;
      border-top: 1px solid #ddd;
    }
    .footer-links {
      display: flex;
      flex-direction: column;
      gap: 5px;
      margin-bottom: 10px;
    }
    .social-icons img {
      width: 24px;
      margin: 0 8px;
      vertical-align: middle;
    }
  </style>
</head>
<body>

<header>
  <img src="dhl-logo.png" class="logo" alt="DHL Logo">
</header>

<div class="container">
  <h2>Commander une expédition</h2>
  <form onsubmit="envoyerCommande(event)">
    <input type="text" id="code" placeholder="Code de suivi" required>
    <input type="text" id="expediteur" placeholder="Nom de l'expéditeur" required>
    <input type="text" id="destinataire" placeholder="Nom du destinataire" required>
    <input type="text" id="adresse" placeholder="Adresse de livraison" required>
    <input type="text" id="colis" placeholder="Nom du colis" required>
    <input type="text" id="trajet" placeholder="Trajet du colis (ex: Pris en charge, Transit, Arrivé à la poste)" required>
    <input type="datetime-local" id="dateExp" required>
    <input type="datetime-local" id="dateArr" required>
    <input type="url" id="photo" placeholder="URL de la photo du colis" required>
    <button type="submit">Commander</button>
    <div class="message" id="confirmation"></div>
  </form>
</div>

<footer>
  <div class="footer-links">
    <span>Mentions légales</span>
    <span>Conditions d'utilisation</span>
    <span>Confidentialité</span>
    <span>Accessibilité</span>
  </div>
  <div class="social-icons">
    <img src="https://cdn-icons-png.flaticon.com/512/1384/1384060.png" alt="YouTube" />
    <img src="https://cdn-icons-png.flaticon.com/512/1384/1384053.png" alt="Facebook" />
    <img src="https://cdn-icons-png.flaticon.com/512/1384/1384014.png" alt="LinkedIn" />
    <img src="https://cdn-icons-png.flaticon.com/512/1384/1384015.png" alt="Instagram" />
  </div>
  <p>2025 © - tous droits réservés</p>
</footer>

<script>
  const supabase = supabase.createClient(
    "https://tuiczkmlmyuchxejsbii.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR1aWN6a21sbXl1Y2h4ZWpzYmlpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc5NDIzNjQsImV4cCI6MjA2MzUxODM2NH0._7fuLrsHu2eotCNXGwS56WdP6XwotcHIE1aQKpi6CMY"
  );

  async function envoyerCommande(e) {
    e.preventDefault();
    const data = {
      code: document.getElementById('code').value,
      expediteur: document.getElementById('expediteur').value,
      destinataire: document.getElementById('destinataire').value,
      adresse: document.getElementById('adresse').value,
      colis: document.getElementById('colis').value,
      trajet: document.getElementById('trajet').value,
      dateExp: document.getElementById('dateExp').value,
      dateArr: document.getElementById('dateArr').value,
      photo: document.getElementById('photo').value
    };

    const { error } = await supabase.from('expeditions').insert([data]);

    if (error) {
      document.getElementById('confirmation').innerHTML = "<span style='color:red;'>Erreur : " + error.message + "</span>";
    } else {
      document.getElementById('confirmation').innerHTML =
        'Commande enregistrée avec succès !<br><a href="suivi.html?code=' + encodeURIComponent(data.code) + '">Voir le suivi du colis</a>';
      e.target.reset();
    }
  }
</script>

</body>
</html>
